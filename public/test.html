<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="lib/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="lib/petal.min.css">
    <link rel="stylesheet/less"  type="text/css" href="styles/test.less">

    <script>
      less = {
        env: "development",
        async: false,
        fileAsync: false,
        poll: 1000,
        functions: {},
        dumpLineNumbers: "comments",
        relativeUrls: false,
        rootpath: ":/triviabeat.io/"
      };
    </script>
    <script src="lib/less.min.js" ></script>
    <script>less.watch();</script>
    <script src="lib/jquery-3.6.0.min.js"></script>

    <title>Log into Trivia Beat</title>

  </head>

  <section>
    <div class="fullpage-modal-container">
      <div class="overlay"></div>
      <div class="fullpage-modal-inner-wrap">
        <div class="fullpage-modal">
          <div class="modal-header">
            <h3 class="modal-header-text">Welcome to Trivia Beat!</h3>
          </div>
          <div class="modal-body">
            <form class="form-horizontal">
              <div class="form-group" >
                <div class="col-1">
                  <div class="btn-group btn-group-segmented">
                  <input disabled type="radio" name="demoSegmented" id="demoSegmented1" >
                  <label for="demoSegmented1"><div class="btn" >Login</div></label>
                  <input type="radio" name="demoSegmented" id="demoSegmented2">
                  <label for="demoSegmented2"><div class="btn red">Register</div></label>
                  </div>
                </div>
              </div>

              <div class="form-group" >
                <div class="input-group col-1">
                  <input class="input " id="demoFormEmail" type="email" placeholder="Email" />
                </div>
              </div>
              <div class="form-group">
                <div class="input-group col-1">
                  <input class="input" id="password" type="password" placeholder="Password" />
                  <input class="input " id="password1" type="text" placeholder="Password" style="display: none"/>
                  <span class="input-addon-btn ">
                  <button class="btn hollow blue petalicon petalicon-eye-closed inner1"></button>
                  </span>
                </div>
              </div>
              <div class="form-group register" style="display: none">
                 <div class="input-group col-1">
                   <input class="input" id="demoForm3Username" type="text"  placeholder="Username" />
                   <span class="input-addon-btn">
                     <button disabled  class="btn red hollow petalicon petalicon-cross inner1"></button>
                   </span>
                 </div>
               </div>
               <div class="form-group register" style="display: none">
                 <div class="input-group col-1">
                   <input type="checkbox" id="checkbox" class="checkbox validation error  col-1" required />
                   <label for="checkbox" >I agree to terms of service.</label>
                 </div>
              </div>
            </form>
          </div>
          <div class="modal-footer btn-row">
            <button class="btn red col-3" disabled>Submit</button>
            <button class="btn red hollow align-right">Help</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    $("#password1").val("");
    $("#password").val("");
    $("#demoFormEmail").val("");
    $("#demoForm3Username").val("");
    $("#demoSegmented1").prop('disabled', true);

    var check;
    $('#demoSegmented2').click(function(){
      document.title = "Register: Trivia Beat"
      check = setInterval(check_username, 1000);
      $("#password1").val("");
      $("#password").val("");
      $(".register").css('display', "block");
      $(".login").css('display', "none");
      $("#demoSegmented1").prop('disabled', false);
      $("#demoSegmented2").prop('disabled', true);
      $(".petalicon-eye-closed").addClass("petalicon-eye");
      $(".petalicon-eye").removeClass("petalicon-eye-closed");
      $("#password1").css("display", 'block');
      $("#password").css("display", 'none');
    });
    $('#demoSegmented1').click(function(){
      document.title = "Log in: Trivia Beat"
      clearInterval(check);
      $("#password1").val("");
      $("#password").val("");
      $(".register").css('display', "none");
      $(".login").css('display', "block");
      $("#demoSegmented2").prop('disabled', false);
      $("#demoSegmented1").prop('disabled', true);
      $(".petalicon-eye").addClass("petalicon-eye-closed");
      $(".petalicon-eye-closed").removeClass("petalicon-eye");
      $("#password1").css("display", 'none');
      $("#password").css("display", 'block');
    });

    $('.petalicon').click(function(){
      if($(".petalicon").hasClass('petalicon-eye-closed')){
        $("#password1").val($("#password").val());
        $(".petalicon-eye-closed").addClass("petalicon-eye");
        $(".petalicon-eye").removeClass("petalicon-eye-closed");
        $("#password").css("display", 'none');
        $("#password1").css("display", 'block');
      }
      else{
        $("#password").val($("#password1").val());
        $(".petalicon-eye").addClass("petalicon-eye-closed");
        $(".petalicon-eye-closed").removeClass("petalicon-eye");
        $("#password1").css("display", 'none');
        $("#password").css("display", 'block');
      }
    });


    function check_username(){
      var name = document.getElementById("demoForm3Username").value;
      name = name.replace(/\s/g,"");
      if(name.length != 0){
        $.ajax({
          url: "/username",
          type: "PUT",
          timeout: 1000,
          headers: {
            username: document.getElementById("demoForm3Username").value
          }
        }).done(function (res) {
          if(res){
            $(".petalicon-cross").addClass("petalicon-check")
            $(".petalicon-cross").removeClass("petalicon-cross")
            $(".petalicon-check").addClass("green")
            $(".petalicon-check").removeClass("red")
          }
          else{
            $(".petalicon-check").addClass("petalicon-cross")
            $(".petalicon-check").removeClass("petalicon-check")
            $(".petalicon-cross").addClass("red")
            $(".petalicon-cross").removeClass("green")
          }
        });
      }else if ($(".petalicon-check") || name.length == 0){
        $(".petalicon-check").addClass("petalicon-cross")
        $(".petalicon-check").removeClass("petalicon-check")
        $(".petalicon-cross").addClass("red")
        $(".petalicon-cross").removeClass("green")
      }
    }
  </script>
</html>
